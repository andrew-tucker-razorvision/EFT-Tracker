# User Experience Polish

## Summary

Improve the EFT-Tracker user experience with three focused enhancements: a quest detail modal for viewing full quest information, mobile responsiveness improvements for better usability on small screens, and refined loading states for smoother interactions.

## Current State Analysis

### Quest Detail View

- Quests display as compact 155x58px nodes with title, level badge, and status indicators
- No way to view full quest details (description, objectives, rewards, prerequisites)
- Users must click wiki link to see detailed information externally
- Focus mode dims unrelated quests but doesn't show more details

### Mobile Responsiveness

- Good foundation with `useIsMobile()` hook and responsive breakpoints
- Quest nodes are fixed size regardless of screen (155x58px)
- Typography doesn't scale (14px title, 12px badges)
- Wiki link icon (18x18px) is small for touch targets
- MiniMap hidden on mobile, controls repositioned

### Loading States

- Excellent skeleton UI for initial page load
- Individual quest save spinners work well
- Missing: button loading states, smooth skeleton transitions, error retry mechanisms

## Proposed Solution

### Approach

Implement three incremental improvements that build on existing patterns:

1. **Quest Detail Modal** - Click-to-expand modal showing full quest information
2. **Mobile Polish** - Responsive typography and improved touch targets
3. **Loading Refinements** - Button loading states and smooth transitions

### Implementation Details

#### Files to Modify

**Quest Detail Modal:**

- `src/components/quest-tree/QuestNode.tsx` - Add click handler to open modal
- `src/components/quest-views/LevelQuestCard.tsx` - Same click handler
- `src/app/quests/QuestsClient.tsx` - Add modal state management

**New Files:**

- `src/components/quest-detail/QuestDetailModal.tsx` - Modal component
- `src/components/quest-detail/ObjectiveList.tsx` - Objective display
- `src/components/quest-detail/RewardDisplay.tsx` - Reward display

**Mobile Polish:**

- `src/components/quest-tree/QuestNode.tsx` - Responsive typography
- `src/components/quest-views/LevelQuestCard.tsx` - Responsive typography
- `src/lib/constants.ts` - Use QUEST_NODE_WIDTH_MOBILE

**Loading Refinements:**

- `src/components/ui/button.tsx` - Add loading prop
- `src/components/quest-tree/QuestFilters.tsx` - Apply button loading state

### Step-by-Step Plan

#### Part 1: Quest Detail Modal (Primary Focus)

1. Create `QuestDetailModal.tsx` using existing Dialog component
   - Header: Quest name, trader icon, level requirement
   - Body sections: Description, Objectives, Rewards, Prerequisites
   - Footer: Wiki link button, Close button

2. Add objective display component
   - List format with map location badges
   - Show FIR requirements with icon
   - Check/uncheck visual for future objective tracking

3. Add reward display component
   - Experience points
   - Trader reputation changes (+ or -)
   - Item rewards with icons

4. Wire up modal to quest nodes
   - Add `onDetailsClick` handler prop to QuestNode
   - Open modal on right-click or long-press (preserve left-click for status toggle)
   - Add small "info" icon button for explicit detail access

5. Connect modal to all view modes
   - QuestNode (trader lanes)
   - LevelQuestCard (level timeline)
   - MapGroupsView cards

#### Part 2: Mobile Polish

6. Implement responsive typography
   - Quest title: `text-sm md:text-base` (12px mobile, 14px desktop)
   - Level badge: `text-xs` (10px) on mobile
   - Use Tailwind responsive classes

7. Improve touch targets
   - Wiki link: min 44x44px touch area (can keep icon small, expand clickable area)
   - Status toggle: already good at 155x58px
   - Info button: min 32x32px

8. Optimize spacing for mobile
   - Reduce quest tree padding on mobile: `p-4 md:p-6`
   - Tighter margins in filter bar

#### Part 3: Loading Refinements

9. Add loading prop to Button component
   - Show spinner icon when `loading={true}`
   - Disable interaction while loading
   - Preserve button width to prevent layout shift

10. Apply to filter Apply button
    - Show loading during filter refetch
    - Use existing `isLoading` state from useQuests

11. Smooth skeleton transitions
    - Add fade-out on skeleton, fade-in on content
    - Use CSS transitions or Framer Motion

## Edge Cases & Error Handling

- **Quest with no objectives**: Show "No objectives listed" message
- **Quest with no rewards**: Show "Standard completion rewards" placeholder
- **Missing prerequisite data**: Show quest IDs with "Details unavailable"
- **Modal on mobile**: Use Sheet (drawer) instead of centered Dialog
- **Long quest names**: Truncate with ellipsis, full name in modal header
- **Network error loading details**: Show cached data with "May be outdated" warning

## Testing Strategy

- [ ] Unit tests for QuestDetailModal render states
- [ ] Unit tests for Button loading prop
- [ ] Manual testing: Open modal from each view mode
- [ ] Manual testing: Mobile viewport in Chrome DevTools
- [ ] Manual testing: Touch interactions on real device
- [ ] Visual testing: Screenshot comparisons before/after

## Risks & Mitigations

| Risk                                       | Mitigation                                          |
| ------------------------------------------ | --------------------------------------------------- |
| Modal feels slow to open                   | Preload quest data, use skeleton in modal           |
| Too much info overwhelms users             | Collapsible sections, start collapsed               |
| Right-click conflicts with browser menu    | Use info button as primary, right-click as shortcut |
| Mobile drawer feels different from desktop | Consistent content, just different container        |

## Scope Boundaries

**In Scope:**

- Quest detail modal with core information
- Basic responsive typography
- Button loading states

**Out of Scope (Future):**

- Objective completion tracking within modal
- Saving filter preferences to server
- Animated transitions between views
- Haptic feedback on mobile
- Keyboard shortcuts

## Success Criteria

1. Users can view full quest details without leaving the app
2. Mobile users have appropriately-sized touch targets
3. Loading states provide clear feedback during operations
4. No regression in existing functionality
